<html tal:define="message view/update">
  <head>
    <title>Create a topic</title>
    <script type="text/javascript">
    // <![CDATA[ 
        function add_smiley(text_to_add) {
            /* add a smiley to the textarea
            */
            // XXX this is a bit scary... the DOM specs say text nodes can
            // be split up, but afaik that never happens in browsers... if,
            // however, people start reporting missing last bits of text, please
            // fix this code... ;)
            var textarea = document.getElementById('text');
            var content = textarea.value;
            var lastchar = content.charAt(content.length - 1);
            if (lastchar && lastchar != ' ' && lastchar != '\t' && lastchar != '\n'
                  && lastchar != '\r') {
                content += ' ';
            };
            content += text_to_add + ' ';
            // XXX please check the argument order here! might be wrong...
            // stupid DOM :(
            textarea.value = content;
        };
    // ]]>
    </script>
    <link rel="stylesheet" type="text/css" media="all"
          tal:attributes="href here/frontend.css/absolute_url" />
  </head>
  <body>
    <p class="forum-message" tal:condition="message" tal:content="message" />
    <form class="forum-form" id="forum-comment-form" method="post"
          tal:attributes="action string:${context/absolute_url}/create_thread.html">
      <div id="post-span">
        <strong>Post a new topic</strong>
      </div>
      <div class="subject">
        <strong>Subject</strong>
      </div>
      <div class="subject-input">
        <input type="text" name="topic" size="79" />
      </div>
      <div id="emoticon-interface">
        <strong>Body text</strong><br />
        <strong>Emoticon interface</strong>
        <div id="emoticons">
          <div class="emoticon" tal:repeat="smileydata view/get_smiley_data">
            <img onclick="add_smiley(this.title)" tal:attributes="title smileydata/text; src smileydata/href" />
          </div>
        </div>
      </div>
      <div id="text-input">
        <div>
          <textarea name="text" id="text" rows="15" cols="67"></textarea>
        </div>
        <div class="submit">
          <input type="submit" value="add thread" />
        </div>
      </div>  
    </form>
  </body>
</html>
