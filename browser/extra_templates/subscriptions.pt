<tal:provider
   i18n:domain="silvaforum"
   tal:define="show_form provider/message">
  <div id="subscriptions-opener" class="dialog-opener"
       tal:define="display python:show_form and 'none' or 'block'"
       tal:attributes="style string:display:${display}">
    <input type="button" id="subscribe-button"
           value="Subscribe / Unsubscribe"
           i18n:attributes="value"
           tal:define="display python:show_form and 'none' or 'block'"
           tal:attributes="style string:display:${display}"
           onclick="document.getElementById('subscriptions-dialog').style.display='block';
                    document.getElementById('subscriptions-opener').style.display='none';"
           />
  </div>
  <div id="subscriptions-dialog" class="forum-dialog"
       tal:define="display python:show_form and 'block' or 'none'"
       tal:attributes="style string:display:${display}">
    <input class="dialog-closer" type="image"
           title="hide post form"
           onclick="document.getElementById('subscriptions-opener').style.display='block';
                    document.getElementById('subscriptions-dialog').style.display='none';"
           tal:attributes="src string:++resource++Products.SilvaForum.browser/close_window.png"
           i18n:attributes="title" />
    <form method="post" name="post" action="#"
          tal:attributes="action context/@@absolute_url">
      <h3 class="heading post-subscription"
          i18n:translate="">
        Subscribe / Unsubscribe
      </h3>

      <p i18n:translate="">
        Fill in your email address if you wish to receive email
        notifications whenever an update occurs. You can cancel your
        notifications at anytime.
      </p>

      <span class="form-status"
         tal:condition="provider/message"
         tal:content="provider/message">
      Status
      </span>

      <label class="field-label" for="form-field-email"
             i18n:translate="">
        Email address
      </label>
      <span class="field-required"
            i18n:translate="">(required)</span>
      <br />
      <span class="field-description"
            i18n:translate="">
        Enter your email address where you would like to receive notifications.
      </span>
      <br />
      <tal:error
        tal:condition="provider/email_missing">
        <span class="field-error"
              i18n:translate="">
          Missing required value.
        </span>
      </tal:error>

      <input type="text" value="" id="form-field-email"
             class="field field-required" name="form.field.email"
             tal:attributes="value provider/email"/>

        <br tal:condition="not:provider/need_captcha" />

        <tal:block
          tal:condition="provider/need_captcha">
          <div class="captcha">
               <label class="field-label captcha" for="form-field-captcha"
                      i18n:translate="">
                 Captcha
               </label>
               <span class="field-required">(required)</span>
               <br />
               <span class="field-description"
                     i18n:translate="">
                 To submit please enter the characters displayed in this image. You can type them in lower case.
               </span>
               <br />
               <span tal:condition="provider/invalid_captcha"
                     i18n:translate="">
                 Invalid or missing captcha value.
               </span>
               <tal:block
                 tal:define="captcha nocall:context/@@captcha">
                 <img tal:replace="structure captcha/image_tag" /><br />
                 <input type="text" value="" id="form-field-captcha"
                        class="field field-required" name="form.field.captcha" />
               </tal:block>
          </div>
        </tal:block>

      <tal:block
        tal:condition="provider/can_subscribe">
         <input type="submit" id="form-action-subscribe"
               name="form.action.subscribe"
               value="Subscribe" class="action"
               i18n:attributes="value"/>
        <tal:block
          tal:condition="provider/can_unsubscribe">
          <input type="submit" id="form-action-unsubscribe"
                 name="form.action.unsubscribe"
                 value="Unsubscribe" class="action"
                 i18n:attributes="value" />
        </tal:block>
      </tal:block>
    </form>
  </div>
</tal:provider>
